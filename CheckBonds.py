import numpy as np

Data="""Fe    0.0000  -0.0000   0.1002
O     1.2135   2.7685  -2.2037
O    -3.0044  -0.3333  -2.2037
O     1.7909  -2.4352  -2.2037
O    -0.5423   3.0419   2.3892
O     2.9055  -1.0513   2.3892
O    -2.3632  -1.9906   2.3892
C     3.9189  -3.2641  -1.4411
C     0.8674   5.0259  -1.4411
C    -4.7863  -1.7618  -1.4411
C    -0.0000   5.2185   1.3893
C     4.5194  -2.6093   1.3893
C    -4.5194  -2.6093   1.3893
O     1.1392   6.9545  -2.6933
O     5.4532  -4.4638  -2.6933
O    -6.5924  -2.4907  -2.6933
O     6.3115  -3.6053   2.4382
O    -0.0335   7.2685   2.4382
O    -6.2780  -3.6633   2.4382
"""

P=[]
for L in Data.split("\n"):
    T=L.split()
    if len(T)<4:
        continue
    
    P+=[{ 'ID':T[0], 'R': np.array([T[1],T[2],T[3]], dtype=float) },]

N=len(P)
for k in range(N):
    Rk=P[k]['R']
    D2=np.zeros( (N,) )
    for kp in range(N):
        D2[kp]=np.sum( (P[kp]['R']-Rk)**2 )

    ii=np.argsort(D2)
    
    Str="%2d : "%(k)
    for l in range(1, min(N,5)):
        Str+=" %2d (%5.3f)"%(ii[l], np.sqrt(D2[ii[l]])*0.53)
    print Str
